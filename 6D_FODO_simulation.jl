using CSV, DataFrames
x_initial = [0.001, 0.0, 0.001, 0.0, 0.0, 0.0]
drift = [1.0 1.0 0.0 0.0 0.0 0.0; 0.0 1.0 0.0 0.0 0.0 0.0; 0.0 0.0 1.0 1.0 0.0 0.0; 0.0 0.0 0.0 1.0 0.0 0.0; 0.0 0.0 0.0 0.0 1.0 0.05215259869194889; 0.0 0.0 0.0 0.0 0.0 1.0]
sector = [1.0 2.4715407073975015 0.0 0.0 0.0 0.3253845070178; 0.0 1.0 0.0 0.0 0.0 0.26330499517479167; 0.0 0.0 0.9655334690533872 2.5 0.0 0.0; 0.0 0.0 -0.02709804805509271 0.9655334690533872 0.0 0.0; -0.26330499517479167 -0.3253845070178 0.0 0.0 1.0 0.10192135683670733; 0.0 0.0 0.0 0.0 0.0 1.0]
QF = [0.979203649740357 0.24826455612607945 0.0 0.0 0.0 0.0; -0.16579173836744285 0.979203649740357 0.0 0.0 0.0 0.0; 0.0 0.0 1.020941519821803 0.2517427023486834 0.0 0.0; 0.0 0.0 0.16811445377047773 1.020941519821803 0.0 0.0; 0.0 0.0 0.0 0.0 1.0 0.013038149672987222; 0.0 0.0 0.0 0.0 0.0 1.0]
QD = [1.078194901679178 0.5129657806920822 0.0 0.0 0.0 0.0; 0.31679354086295064 1.078194901679178 0.0 0.0 0.0 0.0; 0.0 0.0 0.9237915626917542 0.48723286449233166 0.0 0.0; 0.0 0.0 -0.3009016004129462 0.9237915626917542 0.0 0.0; 0.0 0.0 0.0 0.0 1.0 0.026076299345974444; 0.0 0.0 0.0 0.0 0.0 1.0]
x_history = zeros(6, 90)
x = x_initial
x = QD * x
x_history[: , 1] = x
x = drift * x
x_history[: , 2] = x
x = sector * x
x_history[: , 3] = x
x = drift * x
x_history[: , 4] = x
x = QF * x
x_history[: , 5] = x
x = drift * x
x_history[: , 6] = x
x = sector * x
x_history[: , 7] = x
x = drift * x
x_history[: , 8] = x
x = QD * x
x_history[: , 9] = x
x = QD * x
x_history[: , 10] = x
x = drift * x
x_history[: , 11] = x
x = sector * x
x_history[: , 12] = x
x = drift * x
x_history[: , 13] = x
x = QF * x
x_history[: , 14] = x
x = drift * x
x_history[: , 15] = x
x = sector * x
x_history[: , 16] = x
x = drift * x
x_history[: , 17] = x
x = QD * x
x_history[: , 18] = x
x = QD * x
x_history[: , 19] = x
x = drift * x
x_history[: , 20] = x
x = sector * x
x_history[: , 21] = x
x = drift * x
x_history[: , 22] = x
x = QF * x
x_history[: , 23] = x
x = drift * x
x_history[: , 24] = x
x = sector * x
x_history[: , 25] = x
x = drift * x
x_history[: , 26] = x
x = QD * x
x_history[: , 27] = x
x = QD * x
x_history[: , 28] = x
x = drift * x
x_history[: , 29] = x
x = sector * x
x_history[: , 30] = x
x = drift * x
x_history[: , 31] = x
x = QF * x
x_history[: , 32] = x
x = drift * x
x_history[: , 33] = x
x = sector * x
x_history[: , 34] = x
x = drift * x
x_history[: , 35] = x
x = QD * x
x_history[: , 36] = x
x = QD * x
x_history[: , 37] = x
x = drift * x
x_history[: , 38] = x
x = sector * x
x_history[: , 39] = x
x = drift * x
x_history[: , 40] = x
x = QF * x
x_history[: , 41] = x
x = drift * x
x_history[: , 42] = x
x = sector * x
x_history[: , 43] = x
x = drift * x
x_history[: , 44] = x
x = QD * x
x_history[: , 45] = x
x = QD * x
x_history[: , 46] = x
x = drift * x
x_history[: , 47] = x
x = sector * x
x_history[: , 48] = x
x = drift * x
x_history[: , 49] = x
x = QF * x
x_history[: , 50] = x
x = drift * x
x_history[: , 51] = x
x = sector * x
x_history[: , 52] = x
x = drift * x
x_history[: , 53] = x
x = QD * x
x_history[: , 54] = x
x = QD * x
x_history[: , 55] = x
x = drift * x
x_history[: , 56] = x
x = sector * x
x_history[: , 57] = x
x = drift * x
x_history[: , 58] = x
x = QF * x
x_history[: , 59] = x
x = drift * x
x_history[: , 60] = x
x = sector * x
x_history[: , 61] = x
x = drift * x
x_history[: , 62] = x
x = QD * x
x_history[: , 63] = x
x = QD * x
x_history[: , 64] = x
x = drift * x
x_history[: , 65] = x
x = sector * x
x_history[: , 66] = x
x = drift * x
x_history[: , 67] = x
x = QF * x
x_history[: , 68] = x
x = drift * x
x_history[: , 69] = x
x = sector * x
x_history[: , 70] = x
x = drift * x
x_history[: , 71] = x
x = QD * x
x_history[: , 72] = x
x = QD * x
x_history[: , 73] = x
x = drift * x
x_history[: , 74] = x
x = sector * x
x_history[: , 75] = x
x = drift * x
x_history[: , 76] = x
x = QF * x
x_history[: , 77] = x
x = drift * x
x_history[: , 78] = x
x = sector * x
x_history[: , 79] = x
x = drift * x
x_history[: , 80] = x
x = QD * x
x_history[: , 81] = x
x = QD * x
x_history[: , 82] = x
x = drift * x
x_history[: , 83] = x
x = sector * x
x_history[: , 84] = x
x = drift * x
x_history[: , 85] = x
x = QF * x
x_history[: , 86] = x
x = drift * x
x_history[: , 87] = x
x = sector * x
x_history[: , 88] = x
x = drift * x
x_history[: , 89] = x
x = QD * x
x_history[: , 90] = x
df = DataFrame(x_history', [:x, :px, :y, :py, :delta, :z])
CSV.write("FODO_6D_history.csv", df)
